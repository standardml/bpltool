<?xml version="1.0" encoding="ISO-8859-1"?>

<process name="proxy"
  targetNamespace="http://beepell.com/samples/proxy"
  xmlns="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
  xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
  xmlns:me="http://beepell.com/samples/proxy/proxy"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema">

  <import importType="http://schemas.xmlsoap.org/wsdl/"
          namespace="http://beepell.com/samples/proxy/proxy"
          location="proxy.wsdl" />   
  
  <partnerLinks>
    <partnerLink name="clientPartnerLink"
                 partnerLinkType="me:clientPartnerLinkType"
                 myRole="proxyProviderRole" />
    <partnerLink name="serverPartnerLink"
                 partnerLinkType="me:serverPartnerLinkType"
                 partnerRole="serverProviderRole"
                 initializePartnerRole="yes" />  
  </partnerLinks>
  
  <variables>
    <variable name="message" messageType="me:message" />
    <variable name="text" type="xsd:string" />
  </variables>
  
  <sequence>
    
    <receive partnerLink="clientPartnerLink"
             operation="proxyOperation"
             variable="message"
             createInstance="yes" />

    <assign>
      <copy>
        <from>$message.text</from>
        <to variable="text" />
      </copy>
    </assign>

    <invoke partnerLink="serverPartnerLink"
            operation="serverOperation"
            outputVariable="message">
      <toParts>
        <toPart part="text" fromVariable="text" />
      </toParts>
    </invoke>
    
    <reply partnerLink="clientPartnerLink"
           operation="proxyOperation"
           variable="message" />
    
  </sequence>  
  
</process>
