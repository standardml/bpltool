<?xml version="1.0" encoding="ISO-8859-1"?>

<process
  name="proxy"
  targetNamespace="http://beepell.com/samples/proxy"
  xmlns="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
  xmlns:bpel="http://docs.oasis-open.org/wsbpel/2.0/process/executable"
  xmlns:srv="http://beepell.com/samples/proxy/definitions"
  xmlns:xsd="http://www.w3.org/2001/XMLSchema">
   
   <import 
     namespace="http://beepell.com/samples/proxy/definitions" 
     location="./test/com/beepell/deployment/transform/sef-receive-test-case.wsdl" 
     importType="http://schemas.xmlsoap.org/wsdl/"  />   
   
   <partnerLinks>
      <partnerLink
        name="clientPartnerLink"
        partnerLinkType="srv:serviceProviderPartnerLinkType"
        myRole="serviceProviderRole" />

      <partnerLink
        name="serverPartnerLink"
        partnerLinkType="srv:serviceProviderPartnerLinkType"
        myRole="serviceProviderRole" />
        
   </partnerLinks>
   
   <variables>
      <variable name="idVariable" type="xsd:integer" />
      <variable name="descriptionVariable" element="xsd:string" />
      <variable name="approvedVariable" type="xsd:boolean" />
      <variable name="noteVariable" type="xsd:string" />       
      <variable name="addressVariable" element="srv:addressType" />       
      <variable name="request"  messageType="srv:requestMessage" />
      <variable name="response" messageType="srv:responseMessage" />
   </variables>

   <sequence>

      <!--- CORE RECEIVE TEST -->
      <receive
        name="core"
        suppressJoinFailure="yes"
        partnerLink="serverPartnerLink"
        operation="requestService"
        createInstance="no"
        messageExchange="mea"
        variable="request">
        <targets>
          <joinCondition expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
            fn:true()
          </joinCondition>
          <target linkName="ship-to-invoice" />
        </targets> 
        <sources> 
          <source linkName="ship-to-scheduling">
            <transitionCondition expressionLanguage="urn:oasis:names:tc:wsbpel:2.0:sublang:xpath1.0">
                fn:true()
            </transitionCondition>
          </source>
        </sources>    
      </receive>

     <receive
       name="novariable"
       partnerLink="serverPartnerLink"
       operation="noticeService"
       createInstance="no"
       messageExchange="meb"
       suppressJoinFailure="yes"/>
     
       
       <!-- FROM PARTS TESTS -->
       <receive
         name="fromparts"
         partnerLink="serverPartnerLink"
         operation="requestService"
         messageExchange="mec"
         createInstance="no">
         <fromParts>
           <fromPart part="id" toVariable="idVariable" />
           <fromPart part="description" toVariable="descriptionVariable" />
         </fromParts>
       </receive>       

       <!-- ELEMENT VARIABLE MATCHING SINGLE PART TEST -->
       <receive
        name="elements"
        partnerLink="serverPartnerLink"
        operation="simpleService"
        variable="addressVariable"
        messageExchange="med"
        createInstance="no"/>
 
        
        
      <reply
        partnerLink="proxyPartnerLink"
        operation="requestService"
        variable="response"/>
      
   </sequence>  
  
</process>