<r>

<REWRITE_RULESET NAME="PositionUpdate" CONSTRAINT="">

  <REWRITE_RULE NAME="MOVE - SAME FLOOR">

     <RULE_LEFT>
        <positions>
          <pos p1="$beingMoved" p2="$to"/>
          <RULE_HOLE NAME="MORE-POS"/>
        </positions>
        <building>
          <floor p1="$fromFloor">
            <room p1="$from">
              <person p1="$beingMoved"/>
              <RULE_HOLE NAME="FROM-CONTENT"/>
            </room>
            <room p1="$to">
              <RULE_HOLE NAME="TO-CONTENT"/>
            </room>
            <RULE_HOLE NAME="MORE-ROOMS"/>
          </floor>
          <RULE_HOLE NAME="MORE-FLOORS"/>
        </building>
     </RULE_LEFT>

     <RULE_RIGHT>
        <positions>
          <pos p1="$beingMoved" p2="$to"/>
          <RULE_HOLE NAME="MORE-POS"/>
        </positions>
        <building>
          <floor p1="$fromFloor">
            <room p1="$from">
              <RULE_HOLE NAME="FROM-CONTENT"/>
            </room>
            <room p1="$to">
              <RULE_HOLE NAME="TO-CONTENT"/>
              <person p1="$beingMoved"/>
            </room>
            <RULE_HOLE NAME="MORE-ROOMS"/>
          </floor>
          <RULE_HOLE NAME="MORE-FLOORS"/>
        </building>
     </RULE_RIGHT>

  </REWRITE_RULE>

  <REWRITE_RULE NAME="MOVE - DIFFERENT FLOORS">

     <RULE_LEFT>
        <positions>
          <pos p1="$beingMoved" p2="$to"/>
          <RULE_HOLE NAME="MORE-POS"/>
        </positions>
        <building>
          <floor p1="$fromFloor">
            <room p1="$from">
              <person p1="$beingMoved"/>
              <RULE_HOLE NAME="FROM-CONTENT"/>
            </room>
            <RULE_HOLE NAME="FROM-FLOOR-CONTENT"/>
          </floor>
          <floor p1="$toFloor">
            <room p1="$to">
              <RULE_HOLE NAME="TO-CONTENT"/>
            </room>
            <RULE_HOLE NAME="TO-FLOOR-CONTENT"/>
          </floor>
          <RULE_HOLE NAME="MORE-FLOORS"/>
        </building>
     </RULE_LEFT>

     <RULE_RIGHT>
        <positions>
          <pos p1="$beingMoved" p2="$to"/>
          <RULE_HOLE NAME="MORE-POS"/>
        </positions>
        <building>
          <floor p1="$fromFloor">
            <room p1="$from">
              <RULE_HOLE NAME="FROM-CONTENT"/>
            </room>
            <RULE_HOLE NAME="FROM-FLOOR-CONTENT"/>
          </floor>
          <floor p1="$toFloor">
            <room p1="$to">
              <RULE_HOLE NAME="TO-CONTENT"/>
              <person p1="$beingMoved"/>
            </room>
            <RULE_HOLE NAME="TO-FLOOR-CONTENT"/>
          </floor>
          <RULE_HOLE NAME="MORE-FLOORS"/>
        </building>
     </RULE_RIGHT>

  </REWRITE_RULE>

</REWRITE_RULESET>

</r>